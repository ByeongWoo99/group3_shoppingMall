<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="org.example.shoppingmall.repository.complaint.ComplaintRepository">

    <!-- 모든 complaint 목록 조회 -->
    <select id="findAllComplaints" resultType="org.example.shoppingmall.dto.complaint.ComplaintDto">
        SELECT
            complaint_id,
            complaint_type_id,
            refund_method_id,
            order_detail_id,
            employee_id,
            reason,
            pickup_address,
            return_address,
            status,
            description,
            request_datetime,
            received_datetime,
            end_datetime,
            comment,
            return_method,
            expected_refund_amount,
            refund_amount,
            shipping_price,
            detele_flag,
            exchange_product_id
        FROM complaint
    </select>
    
    <!-- 민원 저장 -->
    <insert id="insertComplaint" parameterType="org.example.shoppingmall.dto.complaint.ComplaintDto">
        INSERT INTO complaint (
                               complaint_id,
                               complaint_type_id,
                               reason,
                               description,
                               request_datetime
        ) VALUES (
                  #{complaintId},
                  #{complaintTypeId},
                  #{reason},
                  #{description},
                  #{requestDatetime}
                         )
    </insert>


    <!-- complaintId에 해당하는 민원 상세 정보 조회 -->
    <select id="findComplaintById" resultType="org.example.shoppingmall.dto.complaint.ComplaintDto">
        SELECT complaint_id,
               complaint_type_id,
               order_detail_id,
               request_datetime,
               end_datetime,
               expected_refund_amount,
               refund_amount
        FROM complaint
        WHERE complaint_id = #{complaintId}
    </select>
</mapper>
